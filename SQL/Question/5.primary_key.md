## **主键的相关问题**

### **自增主键的取舍标准？**
- 空间写入成本
    1. B+ 树为了维护索引有序性，在插入新值的时候需要做必要的维护。
    2. 如果在数据页满了情况下，根据 B+ 树的算法，这时候需要申请一个新的数据页，然后挪动部分数据过去。这个过程称为页分裂。
    3. 页分裂操作还影响数据页的利用率。原本放在一个页的数据，现在分到两个页中，整体空间利用率降低大约 50%。
    4. 当然有分裂就有合并。当相邻两个页由于删除了数据，利用率很低之后，会将数据页做合并。合并的过程，可以认为是分裂过程的逆过程。

- 经验
1. 有业务逻辑的字段做主键，则往往不容易保证有序插入，这样写数据成本相对较高
2. 用唯一的身份证号当主键还是使用自增整型主键
    ```sh
    # 如果用身份证号做主键，那么每个二级索引的叶子节点占用约 20 个字节，
    # 如果用整型做主键，则只要 4 个字节，如果是长整型（bigint）则是 8 个字节。
    # 显然，主键长度越小，普通索引的叶子节点就越小，普通索引占用的空间也小
    ```
