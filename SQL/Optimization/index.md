## SQL索引简介 ##
> 如果要定位的数据很多，那么索引就失去它的价值了。因为需要进行很多回表。

### 问题 ###
- 是否需要建立索引，以及建立什么样的索引？
- 为什么索引要存放到硬盘上？                    【永久性存储】
- 使用平衡二叉树作为索引的数据结构有哪些不足？    【树太高，效率不稳定】
- B 树和 B+ 树的结构是怎样的？                  【M叉树，B+树叶子节点形成链表，磁盘IO少】
- 为什么我们常用 B+ 树作为索引的数据结构？       【树矮胖，数据都在叶子节点效率稳定】

### SQL索引的种类 ###
- 普通索引
- 唯一索引
- 主键索引 [只能有一个]
- 全表索引 [MYSQL 目前支持英文]

### SQL索引的分类 ###
- 一张数据表中只能有一个主键索引，这是由主键索引的物理实现方式决定的。，因为数据存储在文件中只能按照一种顺序进行存储。
- 索引可以分类为聚集索引和非聚集索引（二级索引或者辅助索引） 
    1. 聚集索引
        - 按照主键来排序存储数据
        - 【数据直接放到聚集索引的后面】
        - 每一个表只能有一个聚集索引，因为数据行本身只能按一个顺序存储。

    2. 非聚集索引
        - 在数据库系统会有单独的存储空间存放非聚集索引表，这些索引项是按照顺序存储的。
        - 索引项指向的内容是随机存储的。
        - 第一次先找到索引，第二次找到索引对应的位置取出数据行【回表】

    3. 使用聚集索引的时候，数据的查询效率高，但如果对数据进行插入，删除，更新等操作，效率会比非聚集索引低。

- 联合索引存在最左匹配原则，也就是按照最左优先的方式进行索引的匹配

### SQL索引的实现 ###
- B+树索引
    1. M叉树：矮胖可以减少磁盘IO
    2. 数据都在叶子节点，形成有序链表
    
- Hash索引
    1. 使用哈希算法查找数据，查找效率最高
    2. 【不适合重复数据多的列】
    3. Hash表是数组+链表的形式。通过Hash函数可以计算索引键值所对应的bucket（桶）的位置，如果产生Hash冲突，需要遍历链表来解决。

- B+和hash区别：
    1. B+ 支持范围查找，orderby子句，联合索引，最左匹配原则，模糊查询
    2. hash 只是查找效率高

### SQL索引的使用要点 ###
- 多表连接时关联列的数据类型要一致，并且不能连接太多的表
- 索引列应该不允许为NULL，避免全表扫描

- 索引失效的情况
    1. like 查询时开头不能是'%'，否则索引失效。
    2. 使用联合索引查询时要符合最左原则，从中间查索引会失效
    3. 对索引进行计算，函数处理，逻辑运算，索引失效
    4. 在 WHERE 子句中，如果在 OR 前的条件列进行了索引，而在 OR 后的条件列没有进行索引，那么索引会失效

- 不建立索引的情况
    1. 表数据较小1000以下
    2. 数据更新比较频繁的列
    3. 数据值大量重复的列






