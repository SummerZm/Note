## **协议中的版本号的作用**
> **一个成熟稳定项目中协议改动很少，可一旦有改动便是惊天动地，所以协议的可拓展性十分重要**

### **二进制协议VS文本协议**
- **A. 两者主要的区别是对网络带宽的影响和应用层的解析。但tcp和udp已经为我们做很好了**
- **B. 协议字段的设计反应了业务逻辑和解析规则。json传输轻量级的对象也是源于此**

### **应用场景：一个服务端多个客户端**
- **A. 添加一个字段会带来的问题**  
    ```sh
    # 一套协议要面对不同的终端环境实现，对于某资源有限设备有可能导致接收buff溢出
    # 解决方案：通信前进行版本协商
    ```

- **B. 升级更新兼容方面的问题** 
    ```sh
    # 部分终端未升级最新版本或升级到最新版本难度极大
    # 解决方案：在服务器端维护不同版本的终端处理队列
    ```

- **C. 协议中携带版本号的好处**
    ```sh
    # 1. 相对较好的代码独立性，便于维护
    # 2. 容易定位问题,有较好历史线条
    ```

- **D. 旧协议终端误遇新版协议问题处理**
    ```sh
    # 如果没有进行版本协商或者协商出错将导致上述问题
    # 解决方案：
    # 1. 终端严格按照协议的语义实现代码，处理好协议中内部关系的判断和检查，对于不认识的字段不予处理
    # 2. 处于很好的兼容性要可以紧急拓展处理。例如：识别到某紧急标识，调用指定位置的代码或者程序 【参见：TCP紧急处理代码】
    ```





