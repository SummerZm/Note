##  <b>TCP 握手/释放 问题</b> ##

### <b>视角一：网络问题/资源释放 </b> ###
> <b>SYN重复包问题</b>
- 握手一次：无法建立连接
- 握手两次：建立连接 [如果网络由于网络延迟导致客户端多发了SYN包，会导致服务端打开多个无效连接，浪费资源]
- 握手三次：建立稳定连接 [对于网络中多出的重复SYN包，服务端做出响应，客户端如果握手成功，则直接丢弃。如果第三次握手超时失败，则服务端回复Rst结束连接]

### <b>视角二：客户/服务段状态</b> ###
> <b>一个稳定的连接需要客户/服务端知道对端接收和发送能力，Clent 和 Server 通过握手获知自身和对方的接收发送能力 </b>
  
|握手次数|客户端[C]|服务端[S]|
|:---:|:---|:---:|
|第一次握手 C-->S||<b>C发送能力</b> + 自身[S]接收能力|
|第二次握手 S-->C| <b>S接收和S发送能力</b> + 自身[C]发送和接收能力| |
|第三次握手 C-->S| |<b>C接收能力</b> + 自身[S]发送能力 |

### <b>为什么释放是四次挥手</b> ###
- 一端发起连接关闭，对端可能无法立即关闭需要，等待数据区中的发送完毕才能关闭

### <b>SYN工具原理与防护</b> ###
> <b>本质问题：服务器响应SYN请求，导致半连接增多，耗尽资源</b>
- 如何发起SYN攻击？
- 设置半连接监控
-  延缓TCB分配
    - Syn cache
    - Syn cookie
- SYN代理